<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>My Investments</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
body{margin:0;font-family:Arial;background:#020617;color:white}
header{text-align:center;padding:15px;font-size:22px;color:#38bdf8}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:15px;padding:15px}
.card{background:#0f172a;border-radius:14px;padding:10px;text-align:center}
.card img{width:100%;border-radius:10px}
.price{color:#38bdf8;font-weight:bold}
.meta{font-size:12px;color:#cbd5f5}
.calc{width:100%;padding:6px;margin-top:6px}
.live{margin:15px;padding:15px;background:#0f172a;border-radius:12px;text-align:center}
a{color:#38bdf8;text-decoration:none;display:block;text-align:center;margin:15px}
</style>
</head>

<body>

<header>üìÅ My Investments</header>

<div class="live">
  <h3>üìà Live Earnings</h3>
  <div id="live">$0.0000</div>
</div>

<div id="grid" class="grid"></div>

<a href="dashboard.html">‚¨Ö Back to Dashboard</a>

<script>
const nfts = JSON.parse(localStorage.getItem("myNFTs")) || [];
const grid = document.getElementById("grid");
const liveBox = document.getElementById("live");

if(nfts.length === 0){
  grid.innerHTML = "No NFTs purchased";
}

/* RENDER ONCE */
nfts.forEach((nft,i)=>{
  const card = document.createElement("div");
  card.className="card";
  card.innerHTML = `
    <img src="${nft.img}">
    <div class="price">$${nft.price}</div>
    <div class="meta">
      Daily $${nft.dailyIncome}<br>
      Validity ${nft.validity} Days<br>
      365 Days: $${(nft.dailyIncome*365).toFixed(2)}
    </div>
    <input class="calc" type="number" placeholder="Enter days">
    <div class="meta earning">Earning: $0</div>
  `;
  const input = card.querySelector(".calc");
  const out = card.querySelector(".earning");

  input.oninput = ()=> {
    out.innerText =
      "Earning: $" + (input.value * nft.dailyIncome).toFixed(2);
  };

  grid.appendChild(card);
});

/* LIVE EARNINGS ‚Äì NO FLICKER */
setInterval(()=>{
  let total = 0;
  const now = Date.now();

  nfts.forEach(n=>{
    const days = Math.min((now-n.boughtAt)/(1000*60*60*24),365);
    total += days * n.dailyIncome;
  });

  liveBox.innerText = "$" + total.toFixed(4);
},1000);
</script>

</body>
</html>
