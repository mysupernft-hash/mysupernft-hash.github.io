<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SuperNFT Admin Panel</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  margin:0;
  font-family:Arial,Helvetica,sans-serif;
  background:#020617;
  color:#fff;
}
header{
  position:sticky;
  top:0;
  background:#0f172a;
  padding:15px;
  text-align:center;
  font-size:20px;
  color:#22c55e;
  border-bottom:1px solid #1e293b;
}
.container{
  padding:20px;
}
.tx{
  background:#0f172a;
  padding:15px;
  border-radius:14px;
  margin-bottom:15px;
}
.tx b{
  color:#38bdf8;
}
button{
  margin-top:10px;
  padding:8px 14px;
  border:none;
  border-radius:8px;
  cursor:pointer;
  font-weight:bold;
}
.approve{
  background:#22c55e;
  color:#020617;
}
.reject{
  background:#ef4444;
  color:#fff;
  margin-left:10px;
}
.back{
  display:block;
  margin-top:20px;
  text-align:center;
  color:#38bdf8;
  text-decoration:none;
}
.empty{
  text-align:center;
  color:#94a3b8;
}
</style>
</head>

<body>

<header>üõ° Admin ‚Äì Withdraw Approval</header>

<div class="container">
  <div id="list"></div>
  <a class="back" href="dashboard.html">‚Üê Back to Dashboard</a>
</div>

<script>
let withdrawals = JSON.parse(localStorage.getItem("withdrawals")) || [];
let list = document.getElementById("list");

function render(){
  list.innerHTML = "";
  let pendingFound = false;

  withdrawals.forEach((w,i)=>{
    if(w.status==="pending"){
      pendingFound = true;
      list.innerHTML += `
        <div class="tx">
          <b>Amount:</b> $${w.amount}<br>
          <b>Date:</b> ${new Date(w.date).toLocaleString()}<br>
          <b>Status:</b> ${w.status}<br>
          <button class="approve" onclick="approve(${i})">Approve</button>
          <button class="reject" onclick="rejectReq(${i})">Reject</button>
        </div>
      `;
    }
  });

  if(!pendingFound){
    list.innerHTML = `<div class="empty">No pending withdrawals</div>`;
  }
}
render();

function approve(i){
  withdrawals[i].status = "approved";
  save();
  alert("Withdrawal Approved");
}

function rejectReq(i){
  let wallet = Number(localStorage.getItem("walletBalance")) || 0;
  wallet += withdrawals[i].amount;
  localStorage.setItem("walletBalance",wallet);

  withdrawals[i].status = "rejected";
  save();
  alert("Withdrawal Rejected & Amount Refunded");
}

function save(){
  localStorage.setItem("withdrawals",JSON.stringify(withdrawals));
  render();
}
</script>

  <script>
function loadWithdraws(){
  const box = document.getElementById("adminWithdraws");
  const data = JSON.parse(localStorage.getItem("withdrawRequests")) || [];
  box.innerHTML = "";

  data.forEach((w,i)=>{
    box.innerHTML += `
      <div style="border:1px solid #444;padding:10px;margin:10px 0">
        üíµ $${w.amount} <br>
        Status: ${w.status}<br>
        <button onclick="approve(${i})">Approve</button>
        <button onclick="reject(${i})">Reject</button>
      </div>
    `;
  });
}

function approve(i){
  const data = JSON.parse(localStorage.getItem("withdrawRequests"));
  data[i].status = "approved";
  localStorage.setItem("withdrawRequests",JSON.stringify(data));
  loadWithdraws();
}

function reject(i){
  const data = JSON.parse(localStorage.getItem("withdrawRequests"));
  let wallet = Number(localStorage.getItem("walletBalance"));

  // refund money
  wallet += data[i].amount;
  localStorage.setItem("walletBalance",wallet.toFixed(2));

  data[i].status = "rejected";
  localStorage.setItem("withdrawRequests",JSON.stringify(data));
  loadWithdraws();
}

loadWithdraws();
</script>

</body>
</html>
