<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Admin Panel â€“ SuperNFT</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  font-family:Arial;
  background:#020617;
  color:white;
}
header{
  text-align:center;
  padding:15px;
  font-size:22px;
  color:#facc15;
  border-bottom:1px solid #1e293b;
}
.box{
  background:#0f172a;
  margin:15px;
  padding:15px;
  border-radius:12px;
}
table{
  width:100%;
  border-collapse:collapse;
  font-size:13px;
}
th,td{
  border-bottom:1px solid #1e293b;
  padding:8px;
  text-align:left;
}
th{color:#38bdf8}
button{
  padding:6px 10px;
  border:none;
  border-radius:6px;
  font-size:12px;
  cursor:pointer;
}
.approve{background:#22c55e;color:black}
.reject{background:#ef4444;color:white}
.reset{background:#f97316;color:black}
.logout{background:#38bdf8;color:black;margin:10px}
</style>
</head>

<body>

<header>ðŸ›  Admin Panel</header>

<div class="box">
  <h3>ðŸ“Š Platform Summary</h3>
  <div id="summary"></div>
</div>

<div class="box">
  <h3>ðŸ’¸ Withdraw Requests</h3>
  <table>
    <thead>
      <tr>
        <th>Amount</th>
        <th>Fee</th>
        <th>Final</th>
        <th>Wallet</th>
        <th>Status</th>
        <th>Time</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody id="withdrawTable"></tbody>
  </table>
</div>

<div class="box">
  <button class="reset" onclick="resetWithdraws()">Reset Withdraw Requests</button>
  <button class="logout" onclick="logoutAdmin()">Logout Admin</button>
</div>

<script>
/* ===== ADMIN PROTECTION ===== */
if(localStorage.getItem("isAdmin")!=="true"){
  alert("Admin access denied");
  location.href="dashboard.html";
}

/* ===== SUMMARY ===== */
function loadSummary(){
  const nfts = JSON.parse(localStorage.getItem("myNFTs")) || [];
  let invested=0,daily=0;
  nfts.forEach(n=>{
    invested+=n.price;
    daily+=n.daily;
  });

  summary.innerHTML = `
    Total NFTs: ${nfts.length}<br>
    Total Invested: $${invested.toFixed(2)}<br>
    Daily Income: $${daily.toFixed(2)}
  `;
}
loadSummary();

/* ===== WITHDRAW TABLE ===== */
function loadWithdraws(){
  const data = JSON.parse(localStorage.getItem("withdrawRequests")) || [];
  const table = document.getElementById("withdrawTable");
  table.innerHTML="";

  if(data.length===0){
    table.innerHTML="<tr><td colspan='7'>No withdraw requests</td></tr>";
    return;
  }

  data.forEach((r,i)=>{
    table.innerHTML+=`
      <tr>
        <td>$${r.amount}</td>
        <td>$${r.fee.toFixed(2)}</td>
        <td>$${r.final.toFixed(2)}</td>
        <td>${r.wallet}</td>
        <td>${r.status}</td>
        <td>${r.time}</td>
        <td>
          <button class="approve" onclick="approve(${i})">Approve</button>
          <button class="reject" onclick="reject(${i})">Reject</button>
        </td>
      </tr>
    `;
  });
}
loadWithdraws();

/* ===== ACTIONS ===== */
function approve(i){
  const data = JSON.parse(localStorage.getItem("withdrawRequests"));
  data[i].status="Approved";
  localStorage.setItem("withdrawRequests",JSON.stringify(data));
  loadWithdraws();
}

function reject(i){
  const data = JSON.parse(localStorage.getItem("withdrawRequests"));
  data[i].status="Rejected";
  localStorage.setItem("withdrawRequests",JSON.stringify(data));
  loadWithdraws();
}

function resetWithdraws(){
  if(confirm("Reset all withdraw requests?")){
    localStorage.removeItem("withdrawRequests");
    loadWithdraws();
  }
}

function logoutAdmin(){
  localStorage.removeItem("isAdmin");
  alert("Admin logged out");
  location.href="dashboard.html";
}
</script>

</body>
</html>
