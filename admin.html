<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SuperNFT Admin Panel</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  margin:0;
  font-family:Arial,Helvetica,sans-serif;
  background:#020617;
  color:white;
}
header{
  position:sticky;
  top:0;
  background:#020617;
  padding:14px;
  text-align:center;
  font-size:20px;
  font-weight:bold;
  color:#38bdf8;
  border-bottom:1px solid #1e293b;
}
.container{
  padding:15px;
  max-width:600px;
  margin:auto;
}
.box{
  background:#0f172a;
  border-radius:14px;
  padding:15px;
  margin-bottom:15px;
}
.req{
  border-bottom:1px solid #1e293b;
  padding:10px 0;
}
button{
  padding:6px 14px;
  border:none;
  border-radius:8px;
  margin-right:8px;
  cursor:pointer;
  font-weight:bold;
}
.approve{background:#22c55e;color:#020617}
.reject{background:#ef4444;color:white}
input{
  width:100%;
  padding:10px;
  border-radius:10px;
  border:none;
  margin-top:10px;
}
.hidden{display:none}
</style>
</head>

<body>

<header>üõ° Admin Panel</header>

<div class="container">

<!-- ADMIN LOGIN -->
<div class="box" id="loginBox">
  <b>üîê Admin PIN</b>
  <input type="password" id="pin" placeholder="Enter PIN">
  <button onclick="login()" style="margin-top:10px">Login</button>
</div>

<!-- ADMIN PANEL -->
<div id="adminBox" class="hidden">

  <div class="box">
    <b>üí∏ Withdraw Requests</b>
    <div id="requests"></div>
  </div>

  <div class="box">
    <button onclick="logout()" style="background:#ef4444;color:white">
      üîí Logout Admin
    </button>
  </div>

</div>

</div>

<script>
/* ---------- ADMIN LOGIN ---------- */
const ADMIN_PIN="1008";

function login(){
  if(document.getElementById("pin").value===ADMIN_PIN){
    sessionStorage.setItem("adminSession","active");
    document.getElementById("loginBox").style.display="none";
    document.getElementById("adminBox").classList.remove("hidden");
    loadRequests();
  }else{
    alert("Wrong PIN");
  }
}

function logout(){
  sessionStorage.removeItem("adminSession");
  location.reload();
}

/* ---------- SESSION CHECK ---------- */
if(sessionStorage.getItem("adminSession")==="active"){
  document.getElementById("loginBox").style.display="none";
  document.getElementById("adminBox").classList.remove("hidden");
  loadRequests();
}

/* ---------- LOAD WITHDRAW REQUESTS ---------- */
function loadRequests(){
  const history=JSON.parse(localStorage.getItem("walletHistory"))||[];
  const box=document.getElementById("requests");
  box.innerHTML="";

  history.forEach((h,i)=>{
    if(h.type==="Withdraw (Pending)"){
      box.innerHTML+=`
        <div class="req">
          Amount: $${h.amount}<br>
          Time: ${h.time}<br><br>
          <button class="approve" onclick="approve(${i})">Approve</button>
          <button class="reject" onclick="reject(${i})">Reject</button>
        </div>
      `;
    }
  });

  if(box.innerHTML===""){
    box.innerHTML="<small>No pending requests</small>";
  }
}

/* ---------- APPROVE ---------- */
function approve(i){
  const history=JSON.parse(localStorage.getItem("walletHistory"));
  history[i].type="Withdraw (Approved)";
  localStorage.setItem("walletHistory",JSON.stringify(history));
  loadRequests();
}

/* ---------- REJECT ---------- */
function reject(i){
  const history=JSON.parse(localStorage.getItem("walletHistory"));
  let bal=Number(localStorage.getItem("walletBalance"));
  bal+=Number(history[i].amount); // refund
  localStorage.setItem("walletBalance",bal);

  history[i].type="Withdraw (Rejected)";
  localStorage.setItem("walletHistory",JSON.stringify(history));
  loadRequests();
}
</script>

</body>
</html>
