<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>My Team</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{
 background:#0b0f1a;
 color:#fff;
 font-family:Arial;
 margin:0;
 padding:20px;
}
.card{
 background:#111827;
 padding:12px;
 border-radius:10px;
 margin-bottom:10px;
}
</style>
</head>
<body>

<h2>My Team</h2>
<div id="team"></div>

<script type="module">
import { getAuth, onAuthStateChanged } from
"https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
import {
 getFirestore, collection, query, where, getDocs, doc, getDoc
} from
"https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

const auth = getAuth();
const db = getFirestore();
const box = document.getElementById("team");

onAuthStateChanged(auth, async (user)=>{
 if(!user){
  location.href="login.html";
  return;
 }

 // get my referral code
 const mySnap = await getDoc(doc(db,"users",user.uid));
 const myCode = mySnap.data().myReferralCode;

 // find users who joined with my code
 const q = query(
   collection(db,"users"),
   where("referralUsed","==",myCode)
 );

 const snap = await getDocs(q);

 if(snap.empty){
   box.innerHTML="<p>No team members yet</p>";
   return;
 }

 snap.forEach(doc=>{
   box.innerHTML += `
   <div class="card">
     <b>Email:</b> ${doc.data().email}<br>
     <small>Joined</small>
   </div>`;
 });
});
</script>

</body>
</html>
